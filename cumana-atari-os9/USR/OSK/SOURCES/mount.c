/******************************************************************* *                                                                 * *       Dieses Programm ist urheberrechtlich geschuetzt!!!        * *                                                                 * *  Copyrights (c) 1987 by recc-O-ware, Wolfgang Ocker, Puchheim   * *                                                                 * ******************************************************************* ******************************************************************* * Editon History  mount.c * *  #    Date      Comments                                      By * -- --------- ------------------------------------------------ --- * 00  11/05/88 Fixed for release.                               weo * */#include <stdio.h>#include <modes.h>#define TRUE  1#define FALSE 0extern int errno;/* * m a i n */main(argc, argv)  int  argc;  char *argv[];{  int  i, j;  int  devnum;  char drive[200];  int  fd;  int  unmount;  unmount = FALSE;  devnum  = 0;  /*   * Parsing options   */  for (i = 1; i < argc; i++)    if (argv[i][0] == '-')      for (j = 1; j < strlen(argv[i]); j++)        switch (argv[i][j]) {          case '?':            usage();            exit(1);          case 'u':           /* Unmount */            unmount = TRUE;            break;          case 'm':           /* Mount */            unmount = FALSE;            break;          default:            usage();            exit(_errmsg(1, "unknown option '%c'\n", argv[i][j]));        }    else      devnum++;  if (devnum == 0) {      /* Devices given? */    usage();    exit(_errmsg(1, "no drives specified\n"));  }  /*   * Walk through arguments again   */  for (i = 1; i < argc; i++) {    if (argv[i][0] == '-')      /* Option? */      continue;    /*     * Get drive name. Add a leading slash if neccessary     */    sprintf(drive, "%s%s@", argv[i][0] == '/' ? "" : "/", argv[i]);    if ((fd = open(drive, S_IREAD)) < 0) {      _errmsg(errno, "can't open '%s'\n", argv[i]);      continue;    }      if (unmount) {      if (_ss_mount(fd, FALSE) < 0)     /* unmount */        _errmsg(errno, "can't unmount '%s'\n", argv[i]);    }    else      if (_ss_mount(fd, TRUE) < 0)      /* mount */        _errmsg(errno, "can't mount '%s'\n", argv[i]);      close(fd);  }}/* * u s a g e */usage(){  fputs("Syntax: mount <drivename> {<opts>}\n", stderr);  fputs("Function: mount write protected disk\n", stderr);  fputs("Options:\n", stderr);  fputs("     -m    mount disk (default)\n", stderr);  fputs("     -u    unmount disk\n", stderr);}