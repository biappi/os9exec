!file trans!constant bkey, ,a1 = "A"!constant totdb,,m4,"#,###,###.##" = 0!constant totcr,,m4,"#,###,###.##" = 0!temp debt,Debits,m4,"#,###,###.##"!temp cred,Credits,m4,"#,###,###.##"!temp bal,Balance,m4,"#,###,###.##"!temp diff, ,m4,"#,###,###.##"!read bank key=bkey!title bal=b_obal!title print: print "Account: ";b_accno;spc(5);b_name!heading print: printh *t_date,*t_ref,*debt,*cred,*bal!heading print!final print: t_ref = "TOTALS:"!final printh [t_date],t_ref,totdb,totcr!final if bal <> b_cbal then gosub BAL_ERR        keep 4        printh t_date,t_ref,        if t_type = "D" then\                debt = t_amt:\                totdb = totdb + debt:\                bal = bal - debt:\                printh debt,[cred],        if t_type = "C" then\                cred = t_amt:\                totcr = totcr + cred:\                bal = bal + cred:\                printh [debt],cred,        printh bal        endBAL_ERR\        keep 6        print: print "NOTE": print        diff = bal - b_cbal        print "Balance computed from transactions = ";bal        print " Current balance on control record = ";b_cbal        print "                       Discrepancy = ";diff        return