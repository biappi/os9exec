BANK ACCOUNT!file bk bank!file so stand!file tr trans!temp date,Today's date,d4!temp debt,Debits,m4!temp cred,Credits,m4!temp day, ,i1!temp month, ,i1!temp year, ,i2!temp DM, ,i1(12)!temp scrline, ,i2+date,,2,70+b_accno,,5,35+b_name,,7,20+b_obal,,9,35+debt,,10,35,"#,###,###.##"+cred,,11,35,"#,###,###.##"+b_cbal,,12,35+t_date,,14,10+t_ref,,14,32+t_amt,,14,66	gosub SET_MONTHS	display dateX1      b_key = "A"	read bk nsr=X2	debt = 0: cred = 0	display b_accno-b_cbal	gosub POST_SO	endX2      prompt "New account" no=X9	input b_accno-b_obal,b_cbal bs=X2	insert bk: goto X1X9      exit*c=Credits	message "Entering CREDITS"CR1     input t_date-t_amt bs=CR9	gosub INSCRED: goto CR1CR9     clear t_date-t_amt	message ""	end*d=Debits	message "Entering DEBITS"DB1     input t_date-t_amt bs=DB9	gosub INSDEBT: goto DB1DB9     clear t_date-t_amt	message ""	end*f=Find	clear t_date-t_amt	unlock tr	input t_date,t_ref bs=F9	find tr nsr=F1	display t_date-t_amt	endF1      error "No such transaction"F9      end*n=Next	next tr nsr=N1	display t_date-t_amt	endN1      error "No more transactions"	end*r=Remove	check tr nrs=RT1	if t_type = "D" then\		prompt "Remove this debit" no=RT9:\		b_cbal = b_cbal + t_amt:\		debt = debt - t_amt:\		display debt,b_cbal	if t_type = "C" then\		prompt "Remove this credit" no=RT9:\		b_cbal = b_cbal - t_amt:\		cred = cred - t_amt:\		display cred,b_cbal	delete tr	write bk	read bk	clear t_date-t_amt	endRT1     error "No transaction selected"RT9     end*a=Amend	input b_accno-b_obal,b_cbal	write bk	read bk	end*e=Exit	clear	exitPOST_SO\	message "Posting standing orders..."	rewind soU1      next so nsr=U9U2      t_date = so_npd	if t_date = 0 or t_date > date then goto U1	if so_lpd <> 0 and t_date > so_lpd then goto U1	t_ref = so_benf: t_amt = so_amt	display t_date-t_amt	gosub INSDEBT	so_npd = t_date: gosub INCNPD	write so	read so	goto U2U9      clear t_date-t_amt	message ""	returnINSDEBT\	t_type = "D"	insert tr re=TE	b_cbal = b_cbal - t_amt	debt = debt + t_amt	display debt,b_cbal	write bk	read bk	returnINSCRED\	t_type = "C"	insert tr re=TE	b_cbal = b_cbal + t_amt	cred = cred + t_amt	display cred,b_cbal	write bk	read bk	returnTE\	error "Transaction already recorded"	returnINCNPD\	if so_freq = "D" then\		so_npd = so_npd + so_days:\		return	decdate so_npd	if so_freq = "Y" then\		year = year + 1:\		goto INC1	month = month + 1	if month > 12 then\		month = 1:\		year = year + 1INC1    gosub SET_FEB: scroll month	if day > DM then day = DM	encdate so_npd	returnSET_MONTHS\	scroll 1SM1     DM = 30 + (scrline<8 and scrline%2>0) + (scrline>7 and scrline%2=0)	if scrline < 12 then scroll: goto SM1	returnSET_FEB\	scroll 2	DM = 28 + ((year%4 = 0 and year%100 > 0) or year%400 = 0)	return